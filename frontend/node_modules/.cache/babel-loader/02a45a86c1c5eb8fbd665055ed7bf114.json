{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst transporterror_1 = require(\"./transporterror\");\n\nconst XHR = global['XMLHttpRequest'] || require('xmlhttprequest').XMLHttpRequest;\n\nfunction parseResponseHeaders(headerString) {\n  if (!headerString) {\n    return {};\n  }\n\n  return headerString.split('\\u000d\\u000a').map(el => el.split('\\u003a\\u0020')).filter(el => el.length === 2 && el[1].length > 0).reduce((prev, curr) => {\n    prev[curr[0]] = curr[1];\n    return prev;\n  }, {});\n}\n\nfunction extractBody(xhr) {\n  const contentType = xhr.getResponseHeader('Content-Type');\n\n  if (!contentType || contentType.indexOf('application/json') !== 0 || xhr.responseText.length === 0) {\n    return xhr.responseText;\n  }\n\n  try {\n    return JSON.parse(xhr.responseText);\n  } catch (e) {\n    return xhr.responseText;\n  }\n}\n\nfunction adaptHttpResponse(response) {\n  try {\n    response.body = JSON.parse(response.body);\n  } catch (e) {} // eslint-disable-line no-empty\n\n\n  return response;\n}\n/**\n * Provides generic network interface\n */\n\n\nclass Transport {\n  constructor() {}\n\n  static request(method, url, headers, body) {\n    return new Promise((resolve, reject) => {\n      let xhr = new XHR();\n      xhr.open(method, url, true);\n\n      xhr.onreadystatechange = function onreadystatechange() {\n        if (xhr.readyState !== 4) {\n          return;\n        }\n\n        const headers = parseResponseHeaders(xhr.getAllResponseHeaders());\n        const body = extractBody(xhr);\n\n        if (200 <= xhr.status && xhr.status < 300) {\n          resolve({\n            status: xhr.status,\n            headers,\n            body\n          });\n        } else {\n          const status = xhr.statusText && xhr.statusText.code ? xhr.statusText.code : 'NONE';\n          let bodyRepresentation;\n\n          if (typeof body === 'string') {\n            bodyRepresentation = body && body.split('\\n', 2).length === 1 ? body : '';\n          } else {\n            bodyRepresentation = JSON.stringify(body);\n          }\n\n          const message = `${xhr.status}: [${status}] ${bodyRepresentation}`;\n          reject(new transporterror_1.TransportError(message, xhr.status, body, status, headers));\n        }\n      };\n\n      for (let headerName in headers) {\n        xhr.setRequestHeader(headerName, headers[headerName]);\n\n        if (headerName === 'Content-Type' && headers[headerName] === 'application/json') {\n          body = JSON.stringify(body);\n        }\n      }\n\n      xhr.send(body);\n    });\n  }\n  /**\n   * Make a GET request by given URL\n   */\n\n\n  get(url, headers) {\n    return Transport.request('GET', url, headers);\n  }\n  /**\n   * Make a POST request by given URL\n   */\n\n\n  post(url, headers, body) {\n    return Transport.request('POST', url, headers, body);\n  }\n\n}\n\nexports.Transport = Transport;","map":{"version":3,"sources":["/home/ascencion/sebrae_megahack/node_modules/twilio-mcs-client/lib/services/transport.js"],"names":["Object","defineProperty","exports","value","transporterror_1","require","XHR","global","XMLHttpRequest","parseResponseHeaders","headerString","split","map","el","filter","length","reduce","prev","curr","extractBody","xhr","contentType","getResponseHeader","indexOf","responseText","JSON","parse","e","adaptHttpResponse","response","body","Transport","constructor","request","method","url","headers","Promise","resolve","reject","open","onreadystatechange","readyState","getAllResponseHeaders","status","statusText","code","bodyRepresentation","stringify","message","TransportError","headerName","setRequestHeader","send","get","post"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst transporterror_1 = require(\"./transporterror\");\nconst XHR = global['XMLHttpRequest'] || require('xmlhttprequest').XMLHttpRequest;\nfunction parseResponseHeaders(headerString) {\n    if (!headerString) {\n        return {};\n    }\n    return headerString\n        .split('\\u000d\\u000a')\n        .map(el => el.split('\\u003a\\u0020'))\n        .filter(el => el.length === 2 && el[1].length > 0)\n        .reduce((prev, curr) => {\n        prev[curr[0]] = curr[1];\n        return prev;\n    }, {});\n}\nfunction extractBody(xhr) {\n    const contentType = xhr.getResponseHeader('Content-Type');\n    if (!contentType || contentType.indexOf('application/json') !== 0 || xhr.responseText.length === 0) {\n        return xhr.responseText;\n    }\n    try {\n        return JSON.parse(xhr.responseText);\n    }\n    catch (e) {\n        return xhr.responseText;\n    }\n}\nfunction adaptHttpResponse(response) {\n    try {\n        response.body = JSON.parse(response.body);\n    }\n    catch (e) {\n    } // eslint-disable-line no-empty\n    return response;\n}\n/**\n * Provides generic network interface\n */\nclass Transport {\n    constructor() {\n    }\n    static request(method, url, headers, body) {\n        return new Promise((resolve, reject) => {\n            let xhr = new XHR();\n            xhr.open(method, url, true);\n            xhr.onreadystatechange = function onreadystatechange() {\n                if (xhr.readyState !== 4) {\n                    return;\n                }\n                const headers = parseResponseHeaders(xhr.getAllResponseHeaders());\n                const body = extractBody(xhr);\n                if (200 <= xhr.status && xhr.status < 300) {\n                    resolve({ status: xhr.status, headers, body });\n                }\n                else {\n                    const status = xhr.statusText && xhr.statusText.code ? xhr.statusText.code : 'NONE';\n                    let bodyRepresentation;\n                    if (typeof body === 'string') {\n                        bodyRepresentation = body && body.split('\\n', 2).length === 1\n                            ? body\n                            : '';\n                    }\n                    else {\n                        bodyRepresentation = JSON.stringify(body);\n                    }\n                    const message = `${xhr.status}: [${status}] ${bodyRepresentation}`;\n                    reject(new transporterror_1.TransportError(message, xhr.status, body, status, headers));\n                }\n            };\n            for (let headerName in headers) {\n                xhr.setRequestHeader(headerName, headers[headerName]);\n                if (headerName === 'Content-Type' && headers[headerName] === 'application/json') {\n                    body = JSON.stringify(body);\n                }\n            }\n            xhr.send(body);\n        });\n    }\n    /**\n     * Make a GET request by given URL\n     */\n    get(url, headers) {\n        return Transport.request('GET', url, headers);\n    }\n    /**\n     * Make a POST request by given URL\n     */\n    post(url, headers, body) {\n        return Transport.request('POST', url, headers, body);\n    }\n}\nexports.Transport = Transport;\n"]},"metadata":{},"sourceType":"script"}