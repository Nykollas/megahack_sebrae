{"ast":null,"code":"'use strict';\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nvar constants = require('./constants');\n\nvar E = constants.typeErrors,\n    trackPriority = constants.trackPriority;\n\nvar util = require('@twilio/webrtc/lib/util');\n/**\n * Return the given {@link LocalTrack} or a new {@link LocalTrack} for the\n * given MediaStreamTrack.\n * @param {LocalTrack|MediaStreamTrack} track\n * @param {object} options\n * @returns {LocalTrack}\n * @throws {TypeError}\n */\n\n\nfunction asLocalTrack(track, options) {\n  if (track instanceof options.LocalAudioTrack || track instanceof options.LocalVideoTrack || track instanceof options.LocalDataTrack) {\n    return track;\n  }\n\n  if (track instanceof options.MediaStreamTrack) {\n    return track.kind === 'audio' ? new options.LocalAudioTrack(track, options) : new options.LocalVideoTrack(track, options);\n  }\n  /* eslint new-cap:0 */\n\n\n  throw E.INVALID_TYPE('track', 'LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack');\n}\n/**\n * Create a new {@link LocalTrackPublication} for the given {@link LocalTrack}.\n * @param {LocalTrack} track\n * @param {LocalTrackPublicationSignaling} signaling\n * @param {function(track: LocalTrackPublication): void} unpublish\n * @param {object} options\n */\n\n\nfunction asLocalTrackPublication(track, signaling, unpublish, options) {\n  var LocalTrackPublication = {\n    audio: options.LocalAudioTrackPublication,\n    video: options.LocalVideoTrackPublication,\n    data: options.LocalDataTrackPublication\n  }[track.kind];\n  return new LocalTrackPublication(signaling, track, unpublish, options);\n}\n/**\n * Capitalize a word.\n * @param {string} word\n * @returns {string} capitalized\n */\n\n\nfunction capitalize(word) {\n  return word[0].toUpperCase() + word.slice(1);\n}\n/**\n * Log deprecation warnings for the given events of an EventEmitter.\n * @param {string} name\n * @param {EventEmitter} emitter\n * @param {Map<string, string>} events\n * @param {Log} log\n */\n\n\nfunction deprecateEvents(name, emitter, events, log) {\n  var warningsShown = new Set();\n  emitter.on('newListener', function newListener(event) {\n    if (events.has(event) && !warningsShown.has(event)) {\n      log.deprecated(name + '#' + event + ' has been deprecated and scheduled for removal in twilio-video.js@2.0.0.' + (events.get(event) ? ' Use ' + name + '#' + events.get(event) + ' instead.' : ''));\n      warningsShown.add(event);\n    }\n\n    if (warningsShown.size >= events.size) {\n      emitter.removeListener('newListener', newListener);\n    }\n  });\n}\n/**\n * Finds the items in list1 that are not in list2.\n * @param {Array<*>|Map<*>|Set<*>} list1\n * @param {Array<*>|Map<*>|Set<*>} list2\n * @returns {Set}\n */\n\n\nfunction difference(list1, list2) {\n  list1 = Array.isArray(list1) ? new Set(list1) : new Set(list1.values());\n  list2 = Array.isArray(list2) ? new Set(list2) : new Set(list2.values());\n  var difference = new Set();\n  list1.forEach(function (item) {\n    if (!list2.has(item)) {\n      difference.add(item);\n    }\n  });\n  return difference;\n}\n/**\n * Filter out the keys in an object with a given value.\n * @param {object} object - Object to be filtered\n * @param {*} [filterValue] - Value to be filtered out; If not specified, then\n *   filters out all keys which have an explicit value of \"undefined\"\n * @returns {object} - Filtered object\n */\n\n\nfunction filterObject(object, filterValue) {\n  return Object.keys(object).reduce(function (filtered, key) {\n    if (object[key] !== filterValue) {\n      filtered[key] = object[key];\n    }\n\n    return filtered;\n  }, {});\n}\n/**\n * Map a list to an array of arrays, and return the flattened result.\n * @param {Array<*>|Set<*>|Map<*>} list\n * @param {function(*): Array<*>} [mapFn]\n * @returns Array<*>\n */\n\n\nfunction flatMap(list, mapFn) {\n  var listArray = list instanceof Map || list instanceof Set ? Array.from(list.values()) : list;\n\n  mapFn = mapFn || function mapFn(item) {\n    return item;\n  };\n\n  return listArray.reduce(function (flattened, item) {\n    var mapped = mapFn(item);\n    return flattened.concat(mapped);\n  }, []);\n}\n/**\n * Get the user agent string, or return \"Unknown\".\n * @returns {string}\n */\n\n\nfunction getUserAgent() {\n  return typeof navigator !== 'undefined' && navigator.userAgent ? navigator.userAgent : 'Unknown';\n}\n/**\n * Create a unique identifier.\n * @returns {string}\n */\n\n\nfunction makeUUID() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0;\n    var v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n/**\n * Ensure that the given function is called once per tick.\n * @param {function} fn - Function to be executed\n * @returns {function} - Schedules the given function to be called on the next tick\n */\n\n\nfunction oncePerTick(fn) {\n  var timeout = null;\n\n  function nextTick() {\n    timeout = null;\n    fn();\n  }\n\n  return function scheduleNextTick() {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n\n    timeout = setTimeout(nextTick);\n  };\n}\n\nfunction promiseFromEvents(operation, eventEmitter, successEvent, failureEvent) {\n  return new Promise(function (resolve, reject) {\n    function onSuccess() {\n      var args = [].slice.call(arguments);\n\n      if (failureEvent) {\n        eventEmitter.removeListener(failureEvent, onFailure);\n      }\n\n      resolve.apply(undefined, _toConsumableArray(args));\n    }\n\n    function onFailure() {\n      var args = [].slice.call(arguments);\n      eventEmitter.removeListener(successEvent, onSuccess);\n      reject.apply(undefined, _toConsumableArray(args));\n    }\n\n    eventEmitter.once(successEvent, onSuccess);\n\n    if (failureEvent) {\n      eventEmitter.once(failureEvent, onFailure);\n    }\n\n    operation();\n  });\n}\n/**\n * Traverse down multiple nodes on an object and return null if\n * any link in the path is unavailable.\n * @param {Object} obj - Object to traverse\n * @param {String} path - Path to traverse. Period-separated.\n * @returns {Any|null}\n */\n\n\nfunction getOrNull(obj, path) {\n  return path.split('.').reduce(function (output, step) {\n    if (!output) {\n      return null;\n    }\n\n    return output[step];\n  }, obj);\n}\n/**\n * @typedef {object} Deferred\n * @property {Promise} promise\n * @property {function} reject\n * @property {function} resolve\n */\n\n/**\n * Create a {@link Deferred}.\n * @returns {Deferred}\n */\n\n\nfunction defer() {\n  var deferred = {};\n  deferred.promise = new Promise(function (resolve, reject) {\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n/**\n * Copy a method from a `source` prototype onto a `wrapper` prototype. Invoking\n * the method on the `wrapper` prototype will invoke the corresponding method\n * on an instance accessed by `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @param {string} methodName\n * @returns {undefined}\n */\n\n\nfunction delegateMethod(source, wrapper, target, methodName) {\n  if (methodName in wrapper) {\n    // Skip any methods already set.\n    return;\n  } else if (methodName.match(/^on[a-z]+$/)) {\n    // Skip EventHandlers (these are handled in the constructor).\n    return;\n  }\n\n  var type = void 0;\n\n  try {\n    type = _typeof(source[methodName]);\n  } catch (error) {// NOTE(mroberts): Attempting to check the type of non-function members\n    // on the prototype throws an error for some types.\n  }\n\n  if (type !== 'function') {\n    // Skip non-function members.\n    return;\n  }\n  /* eslint no-loop-func:0 */\n\n\n  wrapper[methodName] = function () {\n    var _target;\n\n    return (_target = this[target])[methodName].apply(_target, arguments);\n  };\n}\n/**\n * Copy methods from a `source` prototype onto a `wrapper` prototype. Invoking\n * the methods on the `wrapper` prototype will invoke the corresponding method\n * on an instance accessed by `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @returns {undefined}\n */\n\n\nfunction delegateMethods(source, wrapper, target) {\n  for (var methodName in source) {\n    delegateMethod(source, wrapper, target, methodName);\n  }\n}\n/**\n * Determine whether two values are deeply equal.\n * @param {*} val1\n * @param {*} val2\n * @returns {boolean}\n */\n\n\nfunction isDeepEqual(val1, val2) {\n  if (val1 === val2) {\n    return true;\n  }\n\n  if ((typeof val1 === 'undefined' ? 'undefined' : _typeof(val1)) !== (typeof val2 === 'undefined' ? 'undefined' : _typeof(val2))) {\n    return false;\n  }\n\n  if (val1 === null) {\n    return val2 === null;\n  }\n\n  if (val2 === null) {\n    return false;\n  }\n\n  if (Array.isArray(val1)) {\n    return Array.isArray(val2) && val1.length === val2.length && val1.every(function (val, i) {\n      return isDeepEqual(val, val2[i]);\n    });\n  }\n\n  if ((typeof val1 === 'undefined' ? 'undefined' : _typeof(val1)) === 'object') {\n    var val1Keys = Object.keys(val1).sort();\n    var val2Keys = Object.keys(val2).sort();\n    return !Array.isArray(val2) && isDeepEqual(val1Keys, val2Keys) && val1Keys.every(function (key) {\n      return isDeepEqual(val1[key], val2[key]);\n    });\n  }\n\n  return false;\n}\n/**\n * Whether the given argument is a non-array object.\n * @param {*} object\n * @return {boolean}\n */\n\n\nfunction isNonArrayObject(object) {\n  return (typeof object === 'undefined' ? 'undefined' : _typeof(object)) === 'object' && !Array.isArray(object);\n}\n/**\n * For each property name on the `source` prototype, add getters and/or setters\n * to `wrapper` that proxy to `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @returns {undefined}\n */\n\n\nfunction proxyProperties(source, wrapper, target) {\n  Object.getOwnPropertyNames(source).forEach(function (propertyName) {\n    proxyProperty(source, wrapper, target, propertyName);\n  });\n}\n/**\n * For the property name on the `source` prototype, add a getter and/or setter\n * to `wrapper` that proxies to `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @param {string} propertyName\n * @returns {undefined}\n */\n\n\nfunction proxyProperty(source, wrapper, target, propertyName) {\n  if (propertyName in wrapper) {\n    // Skip any properties already set.\n    return;\n  } else if (propertyName.match(/^on[a-z]+$/)) {\n    Object.defineProperty(wrapper, propertyName, {\n      value: null,\n      writable: true\n    });\n    target.addEventListener(propertyName.slice(2), function () {\n      wrapper.dispatchEvent.apply(wrapper, arguments);\n    });\n    return;\n  }\n\n  Object.defineProperty(wrapper, propertyName, {\n    enumerable: true,\n    get: function get() {\n      return target[propertyName];\n    }\n  });\n}\n/**\n * This is a function for turning a Promise into the kind referenced in the\n * Legacy Interface Extensions section of the WebRTC spec.\n * @param {Promise<*>} promise\n * @param {function<*>} onSuccess\n * @param {function<Error>} onFailure\n * @returns {Promise<undefined>}\n */\n\n\nfunction legacyPromise(promise, onSuccess, onFailure) {\n  if (onSuccess) {\n    return promise.then(function (result) {\n      onSuccess(result);\n    }, function (error) {\n      onFailure(error);\n    });\n  }\n\n  return promise;\n}\n/**\n * Build the {@link LogLevels} object.\n * @param {String|LogLevel} logLevel - Log level name or object\n * @returns {LogLevels}\n */\n\n\nfunction buildLogLevels(logLevel) {\n  if (typeof logLevel === 'string') {\n    return {\n      default: logLevel,\n      media: logLevel,\n      signaling: logLevel,\n      webrtc: logLevel\n    };\n  }\n\n  return logLevel;\n}\n/**\n * Get the {@link Track}'s derived class name\n * @param {Track} track\n * @param {?boolean} [local=undefined]\n * @returns {string}\n */\n\n\nfunction trackClass(track, local) {\n  local = local ? 'Local' : '';\n  return local + (track.kind || '').replace(/\\w{1}/, function (m) {\n    return m.toUpperCase();\n  }) + 'Track';\n}\n/**\n * Get the {@link TrackPublication}'s derived class name\n * @param {TrackPublication} publication\n * @param {?boolean} [local=undefined]\n * @returns {string}\n */\n\n\nfunction trackPublicationClass(publication, local) {\n  local = local ? 'Local' : '';\n  return local + (publication.kind || '').replace(/\\w{1}/, function (m) {\n    return m.toUpperCase();\n  }) + 'TrackPublication';\n}\n/**\n * Sets all underscore-prefixed properties on `object` non-enumerable.\n * @param {Object} object\n * @returns {void}\n */\n\n\nfunction hidePrivateProperties(object) {\n  Object.getOwnPropertyNames(object).forEach(function (name) {\n    if (name.startsWith('_')) {\n      hideProperty(object, name);\n    }\n  });\n}\n/**\n * Creates a new subclass which, in the constructor, sets all underscore-prefixed\n * properties and the given public properties non-enumerable. This is useful for\n * patching up classes like EventEmitter which may set properties like `_events`\n * and `domain`.\n * @param {Function} klass\n * @param {Array<string>} props\n * @returns {Function} subclass\n */\n\n\nfunction hidePrivateAndCertainPublicPropertiesInClass(klass, props) {\n  // NOTE(mroberts): We do this to avoid giving the class a name.\n  return function (_klass) {\n    _inherits(_class, _klass);\n\n    function _class() {\n      var _ref;\n\n      _classCallCheck(this, _class);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var _this = _possibleConstructorReturn(this, (_ref = _class.__proto__ || Object.getPrototypeOf(_class)).call.apply(_ref, [this].concat(args)));\n\n      hidePrivateProperties(_this);\n      hidePublicProperties(_this, props);\n      return _this;\n    }\n\n    return _class;\n  }(klass);\n}\n/**\n * Hide a property of an object.\n * @param {object} object\n * @param {string} name\n */\n\n\nfunction hideProperty(object, name) {\n  var descriptor = Object.getOwnPropertyDescriptor(object, name);\n  descriptor.enumerable = false;\n  Object.defineProperty(object, name, descriptor);\n}\n/**\n * Hide the given public properties of an object.\n * @param {object} object\n * @param {Array<string>} [props=[]]\n */\n\n\nfunction hidePublicProperties(object) {\n  var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  props.forEach(function (name) {\n    // eslint-disable-next-line no-prototype-builtins\n    if (object.hasOwnProperty(name)) {\n      hideProperty(object, name);\n    }\n  });\n}\n/**\n * Convert an Array of values to an Array of JSON values by calling\n * `valueToJSON` on each value.\n * @param {Array<*>} array\n * @returns {Array<*>}\n */\n\n\nfunction arrayToJSON(array) {\n  return array.map(valueToJSON);\n}\n/**\n * Convert a Set of values to an Array of JSON values by calling `valueToJSON`\n * on each value.\n * @param {Set<*>} set\n * @returns {Array<*>}\n */\n\n\nfunction setToJSON(set) {\n  return arrayToJSON([].concat(_toConsumableArray(set)));\n}\n/**\n * Convert a Map from strings to values to an object of JSON values by calling\n * `valueToJSON` on each value.\n * @param {Map<string, *>} map\n * @returns {object}\n */\n\n\nfunction mapToJSON(map) {\n  return [].concat(_toConsumableArray(map.entries())).reduce(function (json, _ref2) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        key = _ref3[0],\n        value = _ref3[1];\n\n    return Object.assign(_defineProperty({}, key, valueToJSON(value)), json);\n  }, {});\n}\n/**\n * Convert an object to a JSON value by calling `valueToJSON` on its enumerable\n * keys.\n * @param {object} object\n * @returns {object}\n */\n\n\nfunction objectToJSON(object) {\n  return Object.entries(object).reduce(function (json, _ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        key = _ref5[0],\n        value = _ref5[1];\n\n    return Object.assign(_defineProperty({}, key, valueToJSON(value)), json);\n  }, {});\n}\n/**\n * Convert a value into a JSON value.\n * @param {*} value\n * @returns {*}\n */\n\n\nfunction valueToJSON(value) {\n  if (Array.isArray(value)) {\n    return arrayToJSON(value);\n  } else if (value instanceof Set) {\n    return setToJSON(value);\n  } else if (value instanceof Map) {\n    return mapToJSON(value);\n  } else if (value && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object') {\n    return objectToJSON(value);\n  }\n\n  return value;\n}\n/**\n * Create the bandwidth profile payload included in an RSP connect message.\n * @param {BandwidthProfileOptions} bandwidthProfile\n * @returns {object}\n */\n\n\nfunction createBandwidthProfilePayload(bandwidthProfile) {\n  return createRSPPayload(bandwidthProfile, [{\n    prop: 'video',\n    type: 'object',\n    transform: createBandwidthProfileVideoPayload\n  }]);\n}\n/**\n * Create the bandwidth profile video payload included in an RSP connect message.\n * @param {VideoBandwidthProfileOptions} bandwidthProfileVideo\n * @returns {object}\n */\n\n\nfunction createBandwidthProfileVideoPayload(bandwidthProfileVideo) {\n  return createRSPPayload(bandwidthProfileVideo, [{\n    prop: 'dominantSpeakerPriority',\n    type: 'string',\n    payloadProp: 'active_speaker_priority'\n  }, {\n    prop: 'maxSubscriptionBitrate',\n    type: 'number',\n    payloadProp: 'max_subscription_bandwidth'\n  }, {\n    prop: 'maxTracks',\n    type: 'number',\n    payloadProp: 'max_tracks'\n  }, {\n    prop: 'mode',\n    type: 'string'\n  }, {\n    prop: 'renderDimensions',\n    type: 'object',\n    payloadProp: 'render_dimensions',\n    transform: createRenderDimensionsPayload\n  }, {\n    prop: 'trackSwitchOffMode',\n    type: 'string',\n    payloadProp: 'track_switch_off'\n  }]);\n}\n/**\n * Create the Media Signaling payload included in an RSP connect message.\n * @param {boolean} dominantSpeaker - whether to enable the Dominant Speaker\n *   protocol or not\n * @param {boolean} networkQuality - whether to enable the Network Quality\n *   protocol or not\n * @param {boolean} trackPriority - whether to enable the Track Priority\n *   protocol or not\n * @param {boolean} trackSwitchOff - whether to enable the Track Switch-Off\n *   protocol or not.\n * @returns {object}\n */\n\n\nfunction createMediaSignalingPayload(dominantSpeaker, networkQuality, trackPriority, trackSwitchOff) {\n  var transports = {\n    transports: [{\n      type: 'data-channel'\n    }]\n  };\n  return Object.assign(dominantSpeaker // eslint-disable-next-line\n  ? {\n    active_speaker: transports\n  } : {}, networkQuality // eslint-disable-next-line\n  ? {\n    network_quality: transports\n  } : {}, trackPriority // eslint-disable-next-line\n  ? {\n    track_priority: transports\n  } : {}, trackSwitchOff // eslint-disable-next-line\n  ? {\n    track_switch_off: transports\n  } : {});\n}\n/**\n * Create {@link VideoTrack.Dimensions} RSP payload.\n * @param {VideoTrack.Dimensions} [dimensions]\n * @returns {object}\n */\n\n\nfunction createDimensionsPayload(dimensions) {\n  return createRSPPayload(dimensions, [{\n    prop: 'height',\n    type: 'number'\n  }, {\n    prop: 'width',\n    type: 'number'\n  }]);\n}\n/**\n * Create {@link VideoRenderDimensions} RSP payload.\n * @param renderDimensions\n * @returns {object}\n */\n\n\nfunction createRenderDimensionsPayload(renderDimensions) {\n  var PRIORITY_HIGH = trackPriority.PRIORITY_HIGH,\n      PRIORITY_LOW = trackPriority.PRIORITY_LOW,\n      PRIORITY_STANDARD = trackPriority.PRIORITY_STANDARD;\n  return createRSPPayload(renderDimensions, [{\n    prop: PRIORITY_HIGH,\n    type: 'object',\n    transform: createDimensionsPayload\n  }, {\n    prop: PRIORITY_LOW,\n    type: 'object',\n    transform: createDimensionsPayload\n  }, {\n    prop: PRIORITY_STANDARD,\n    type: 'object',\n    transform: createDimensionsPayload\n  }]);\n}\n/**\n * Create an RSP payload for the given object.\n * @param {object} object - object for which RSP payload is to be generated\n * @param {Array<object>} propConversions - conversion rules for object properties;\n *   they specify how object properties should be converted to their corresponding\n *   RSP payload properties\n * @returns {object}\n */\n\n\nfunction createRSPPayload(object, propConversions) {\n  return propConversions.reduce(function (payload, _ref6) {\n    var prop = _ref6.prop,\n        type = _ref6.type,\n        _ref6$payloadProp = _ref6.payloadProp,\n        payloadProp = _ref6$payloadProp === undefined ? prop : _ref6$payloadProp,\n        _ref6$transform = _ref6.transform,\n        transform = _ref6$transform === undefined ? function (x) {\n      return x;\n    } : _ref6$transform;\n    return _typeof(object[prop]) === type ? Object.assign(_defineProperty({}, payloadProp, transform(object[prop])), payload) : payload;\n  }, {});\n}\n/**\n * Create the subscribe payload included in an RSP connect/update message.\n * @param {boolean} automaticSubscription - whether to subscribe to all RemoteTracks\n * @returns {object}\n */\n\n\nfunction createSubscribePayload(automaticSubscription) {\n  return {\n    rules: [{\n      type: automaticSubscription ? 'include' : 'exclude',\n      all: true\n    }],\n    revision: 1\n  };\n}\n/**\n * Add random jitter to a given value in the range [-jitter, jitter].\n * @private\n * @param {number} value\n * @param {number} jitter\n * @returns {number} value + random(-jitter, +jitter)\n */\n\n\nfunction withJitter(value, jitter) {\n  var rand = Math.random();\n  return value - jitter + Math.floor(2 * jitter * rand + 0.5);\n}\n/**\n * Checks if the a number is in the range [min, max].\n * @private\n * @param {num} num\n * @param {number} min\n * @param {number} max\n * @return {boolean}\n */\n\n\nfunction inRange(num, min, max) {\n  return min <= num && num <= max;\n}\n/**\n * returns true if given MediaStreamTrack is a screen share track\n * @private\n * @param {MediaStreamTrack} track\n * @returns {boolean}\n */\n\n\nfunction isChromeScreenShareTrack(track) {\n  // NOTE(mpatwardhan): Chrome creates screen share tracks with label like: \"screen:69734272*\"\n  // we will check for label that starts with \"screen:D\" where D being a digit.\n  var isChrome = util.guessBrowser() === 'chrome';\n  return isChrome && track.kind === 'video' && track.label && /^screen:[0-9]+/.test(track.label);\n}\n\nexports.constants = constants;\nexports.createBandwidthProfilePayload = createBandwidthProfilePayload;\nexports.createMediaSignalingPayload = createMediaSignalingPayload;\nexports.createSubscribePayload = createSubscribePayload;\nexports.asLocalTrack = asLocalTrack;\nexports.asLocalTrackPublication = asLocalTrackPublication;\nexports.capitalize = capitalize;\nexports.deprecateEvents = deprecateEvents;\nexports.difference = difference;\nexports.filterObject = filterObject;\nexports.flatMap = flatMap;\nexports.getUserAgent = getUserAgent;\nexports.hidePrivateProperties = hidePrivateProperties;\nexports.hidePrivateAndCertainPublicPropertiesInClass = hidePrivateAndCertainPublicPropertiesInClass;\nexports.isDeepEqual = isDeepEqual;\nexports.isNonArrayObject = isNonArrayObject;\nexports.inRange = inRange;\nexports.makeUUID = makeUUID;\nexports.oncePerTick = oncePerTick;\nexports.promiseFromEvents = promiseFromEvents;\nexports.getOrNull = getOrNull;\nexports.defer = defer;\nexports.delegateMethods = delegateMethods;\nexports.proxyProperties = proxyProperties;\nexports.legacyPromise = legacyPromise;\nexports.buildLogLevels = buildLogLevels;\nexports.trackClass = trackClass;\nexports.trackPublicationClass = trackPublicationClass;\nexports.valueToJSON = valueToJSON;\nexports.withJitter = withJitter;\nexports.isChromeScreenShareTrack = isChromeScreenShareTrack;","map":{"version":3,"sources":["/home/ascencion/sebrae_megahack/node_modules/twilio-video/es5/util/index.js"],"names":["_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","push","value","length","err","Array","isArray","Object","TypeError","_typeof","obj","constructor","prototype","_defineProperty","key","defineProperty","enumerable","configurable","writable","_classCallCheck","instance","Constructor","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","_toConsumableArray","arr2","from","constants","require","E","typeErrors","trackPriority","util","asLocalTrack","track","options","LocalAudioTrack","LocalVideoTrack","LocalDataTrack","MediaStreamTrack","kind","INVALID_TYPE","asLocalTrackPublication","signaling","unpublish","LocalTrackPublication","audio","LocalAudioTrackPublication","video","LocalVideoTrackPublication","data","LocalDataTrackPublication","capitalize","word","toUpperCase","slice","deprecateEvents","name","emitter","events","log","warningsShown","Set","on","newListener","event","has","deprecated","get","add","size","removeListener","difference","list1","list2","values","forEach","item","filterObject","object","filterValue","keys","reduce","filtered","flatMap","list","mapFn","listArray","Map","flattened","mapped","concat","getUserAgent","navigator","userAgent","makeUUID","replace","c","r","Math","random","v","toString","oncePerTick","fn","timeout","nextTick","scheduleNextTick","clearTimeout","setTimeout","promiseFromEvents","operation","eventEmitter","successEvent","failureEvent","Promise","resolve","reject","onSuccess","args","arguments","onFailure","apply","once","getOrNull","path","split","output","step","defer","deferred","promise","delegateMethod","source","wrapper","target","methodName","match","type","error","_target","delegateMethods","isDeepEqual","val1","val2","every","val","val1Keys","sort","val2Keys","isNonArrayObject","proxyProperties","getOwnPropertyNames","propertyName","proxyProperty","addEventListener","dispatchEvent","legacyPromise","then","result","buildLogLevels","logLevel","default","media","webrtc","trackClass","local","m","trackPublicationClass","publication","hidePrivateProperties","startsWith","hideProperty","hidePrivateAndCertainPublicPropertiesInClass","klass","props","_klass","_class","_ref","_len","_key","_this","getPrototypeOf","hidePublicProperties","descriptor","getOwnPropertyDescriptor","hasOwnProperty","arrayToJSON","array","map","valueToJSON","setToJSON","set","mapToJSON","entries","json","_ref2","_ref3","assign","objectToJSON","_ref4","_ref5","createBandwidthProfilePayload","bandwidthProfile","createRSPPayload","prop","transform","createBandwidthProfileVideoPayload","bandwidthProfileVideo","payloadProp","createRenderDimensionsPayload","createMediaSignalingPayload","dominantSpeaker","networkQuality","trackSwitchOff","transports","active_speaker","network_quality","track_priority","track_switch_off","createDimensionsPayload","dimensions","renderDimensions","PRIORITY_HIGH","PRIORITY_LOW","PRIORITY_STANDARD","propConversions","payload","_ref6","_ref6$payloadProp","_ref6$transform","x","createSubscribePayload","automaticSubscription","rules","all","revision","withJitter","jitter","rand","floor","inRange","num","min","max","isChromeScreenShareTrack","isChrome","guessBrowser","label","test","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar constants = require('./constants');\nvar E = constants.typeErrors,\n    trackPriority = constants.trackPriority;\n\nvar util = require('@twilio/webrtc/lib/util');\n\n/**\n * Return the given {@link LocalTrack} or a new {@link LocalTrack} for the\n * given MediaStreamTrack.\n * @param {LocalTrack|MediaStreamTrack} track\n * @param {object} options\n * @returns {LocalTrack}\n * @throws {TypeError}\n */\nfunction asLocalTrack(track, options) {\n  if (track instanceof options.LocalAudioTrack || track instanceof options.LocalVideoTrack || track instanceof options.LocalDataTrack) {\n    return track;\n  }\n  if (track instanceof options.MediaStreamTrack) {\n    return track.kind === 'audio' ? new options.LocalAudioTrack(track, options) : new options.LocalVideoTrack(track, options);\n  }\n  /* eslint new-cap:0 */\n  throw E.INVALID_TYPE('track', 'LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack');\n}\n\n/**\n * Create a new {@link LocalTrackPublication} for the given {@link LocalTrack}.\n * @param {LocalTrack} track\n * @param {LocalTrackPublicationSignaling} signaling\n * @param {function(track: LocalTrackPublication): void} unpublish\n * @param {object} options\n */\nfunction asLocalTrackPublication(track, signaling, unpublish, options) {\n  var LocalTrackPublication = {\n    audio: options.LocalAudioTrackPublication,\n    video: options.LocalVideoTrackPublication,\n    data: options.LocalDataTrackPublication\n  }[track.kind];\n  return new LocalTrackPublication(signaling, track, unpublish, options);\n}\n\n/**\n * Capitalize a word.\n * @param {string} word\n * @returns {string} capitalized\n */\nfunction capitalize(word) {\n  return word[0].toUpperCase() + word.slice(1);\n}\n\n/**\n * Log deprecation warnings for the given events of an EventEmitter.\n * @param {string} name\n * @param {EventEmitter} emitter\n * @param {Map<string, string>} events\n * @param {Log} log\n */\nfunction deprecateEvents(name, emitter, events, log) {\n  var warningsShown = new Set();\n  emitter.on('newListener', function newListener(event) {\n    if (events.has(event) && !warningsShown.has(event)) {\n      log.deprecated(name + '#' + event + ' has been deprecated and scheduled for removal in twilio-video.js@2.0.0.' + (events.get(event) ? ' Use ' + name + '#' + events.get(event) + ' instead.' : ''));\n      warningsShown.add(event);\n    }\n    if (warningsShown.size >= events.size) {\n      emitter.removeListener('newListener', newListener);\n    }\n  });\n}\n\n/**\n * Finds the items in list1 that are not in list2.\n * @param {Array<*>|Map<*>|Set<*>} list1\n * @param {Array<*>|Map<*>|Set<*>} list2\n * @returns {Set}\n */\nfunction difference(list1, list2) {\n  list1 = Array.isArray(list1) ? new Set(list1) : new Set(list1.values());\n  list2 = Array.isArray(list2) ? new Set(list2) : new Set(list2.values());\n\n  var difference = new Set();\n\n  list1.forEach(function (item) {\n    if (!list2.has(item)) {\n      difference.add(item);\n    }\n  });\n\n  return difference;\n}\n\n/**\n * Filter out the keys in an object with a given value.\n * @param {object} object - Object to be filtered\n * @param {*} [filterValue] - Value to be filtered out; If not specified, then\n *   filters out all keys which have an explicit value of \"undefined\"\n * @returns {object} - Filtered object\n */\nfunction filterObject(object, filterValue) {\n  return Object.keys(object).reduce(function (filtered, key) {\n    if (object[key] !== filterValue) {\n      filtered[key] = object[key];\n    }\n    return filtered;\n  }, {});\n}\n\n/**\n * Map a list to an array of arrays, and return the flattened result.\n * @param {Array<*>|Set<*>|Map<*>} list\n * @param {function(*): Array<*>} [mapFn]\n * @returns Array<*>\n */\nfunction flatMap(list, mapFn) {\n  var listArray = list instanceof Map || list instanceof Set ? Array.from(list.values()) : list;\n\n  mapFn = mapFn || function mapFn(item) {\n    return item;\n  };\n\n  return listArray.reduce(function (flattened, item) {\n    var mapped = mapFn(item);\n    return flattened.concat(mapped);\n  }, []);\n}\n\n/**\n * Get the user agent string, or return \"Unknown\".\n * @returns {string}\n */\nfunction getUserAgent() {\n  return typeof navigator !== 'undefined' && navigator.userAgent ? navigator.userAgent : 'Unknown';\n}\n\n/**\n * Create a unique identifier.\n * @returns {string}\n */\nfunction makeUUID() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0;\n    var v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\n/**\n * Ensure that the given function is called once per tick.\n * @param {function} fn - Function to be executed\n * @returns {function} - Schedules the given function to be called on the next tick\n */\nfunction oncePerTick(fn) {\n  var timeout = null;\n\n  function nextTick() {\n    timeout = null;\n    fn();\n  }\n\n  return function scheduleNextTick() {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n    timeout = setTimeout(nextTick);\n  };\n}\n\nfunction promiseFromEvents(operation, eventEmitter, successEvent, failureEvent) {\n  return new Promise(function (resolve, reject) {\n    function onSuccess() {\n      var args = [].slice.call(arguments);\n      if (failureEvent) {\n        eventEmitter.removeListener(failureEvent, onFailure);\n      }\n      resolve.apply(undefined, _toConsumableArray(args));\n    }\n    function onFailure() {\n      var args = [].slice.call(arguments);\n      eventEmitter.removeListener(successEvent, onSuccess);\n      reject.apply(undefined, _toConsumableArray(args));\n    }\n    eventEmitter.once(successEvent, onSuccess);\n    if (failureEvent) {\n      eventEmitter.once(failureEvent, onFailure);\n    }\n    operation();\n  });\n}\n\n/**\n * Traverse down multiple nodes on an object and return null if\n * any link in the path is unavailable.\n * @param {Object} obj - Object to traverse\n * @param {String} path - Path to traverse. Period-separated.\n * @returns {Any|null}\n */\nfunction getOrNull(obj, path) {\n  return path.split('.').reduce(function (output, step) {\n    if (!output) {\n      return null;\n    }\n    return output[step];\n  }, obj);\n}\n\n/**\n * @typedef {object} Deferred\n * @property {Promise} promise\n * @property {function} reject\n * @property {function} resolve\n */\n\n/**\n * Create a {@link Deferred}.\n * @returns {Deferred}\n */\nfunction defer() {\n  var deferred = {};\n  deferred.promise = new Promise(function (resolve, reject) {\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n/**\n * Copy a method from a `source` prototype onto a `wrapper` prototype. Invoking\n * the method on the `wrapper` prototype will invoke the corresponding method\n * on an instance accessed by `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @param {string} methodName\n * @returns {undefined}\n */\nfunction delegateMethod(source, wrapper, target, methodName) {\n  if (methodName in wrapper) {\n    // Skip any methods already set.\n    return;\n  } else if (methodName.match(/^on[a-z]+$/)) {\n    // Skip EventHandlers (these are handled in the constructor).\n    return;\n  }\n\n  var type = void 0;\n  try {\n    type = _typeof(source[methodName]);\n  } catch (error) {\n    // NOTE(mroberts): Attempting to check the type of non-function members\n    // on the prototype throws an error for some types.\n  }\n\n  if (type !== 'function') {\n    // Skip non-function members.\n    return;\n  }\n\n  /* eslint no-loop-func:0 */\n  wrapper[methodName] = function () {\n    var _target;\n\n    return (_target = this[target])[methodName].apply(_target, arguments);\n  };\n}\n\n/**\n * Copy methods from a `source` prototype onto a `wrapper` prototype. Invoking\n * the methods on the `wrapper` prototype will invoke the corresponding method\n * on an instance accessed by `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @returns {undefined}\n */\nfunction delegateMethods(source, wrapper, target) {\n  for (var methodName in source) {\n    delegateMethod(source, wrapper, target, methodName);\n  }\n}\n\n/**\n * Determine whether two values are deeply equal.\n * @param {*} val1\n * @param {*} val2\n * @returns {boolean}\n */\nfunction isDeepEqual(val1, val2) {\n  if (val1 === val2) {\n    return true;\n  }\n  if ((typeof val1 === 'undefined' ? 'undefined' : _typeof(val1)) !== (typeof val2 === 'undefined' ? 'undefined' : _typeof(val2))) {\n    return false;\n  }\n  if (val1 === null) {\n    return val2 === null;\n  }\n  if (val2 === null) {\n    return false;\n  }\n  if (Array.isArray(val1)) {\n    return Array.isArray(val2) && val1.length === val2.length && val1.every(function (val, i) {\n      return isDeepEqual(val, val2[i]);\n    });\n  }\n  if ((typeof val1 === 'undefined' ? 'undefined' : _typeof(val1)) === 'object') {\n    var val1Keys = Object.keys(val1).sort();\n    var val2Keys = Object.keys(val2).sort();\n    return !Array.isArray(val2) && isDeepEqual(val1Keys, val2Keys) && val1Keys.every(function (key) {\n      return isDeepEqual(val1[key], val2[key]);\n    });\n  }\n  return false;\n}\n\n/**\n * Whether the given argument is a non-array object.\n * @param {*} object\n * @return {boolean}\n */\nfunction isNonArrayObject(object) {\n  return (typeof object === 'undefined' ? 'undefined' : _typeof(object)) === 'object' && !Array.isArray(object);\n}\n\n/**\n * For each property name on the `source` prototype, add getters and/or setters\n * to `wrapper` that proxy to `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @returns {undefined}\n */\nfunction proxyProperties(source, wrapper, target) {\n  Object.getOwnPropertyNames(source).forEach(function (propertyName) {\n    proxyProperty(source, wrapper, target, propertyName);\n  });\n}\n\n/**\n * For the property name on the `source` prototype, add a getter and/or setter\n * to `wrapper` that proxies to `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @param {string} propertyName\n * @returns {undefined}\n */\nfunction proxyProperty(source, wrapper, target, propertyName) {\n  if (propertyName in wrapper) {\n    // Skip any properties already set.\n    return;\n  } else if (propertyName.match(/^on[a-z]+$/)) {\n    Object.defineProperty(wrapper, propertyName, {\n      value: null,\n      writable: true\n    });\n\n    target.addEventListener(propertyName.slice(2), function () {\n      wrapper.dispatchEvent.apply(wrapper, arguments);\n    });\n\n    return;\n  }\n\n  Object.defineProperty(wrapper, propertyName, {\n    enumerable: true,\n    get: function get() {\n      return target[propertyName];\n    }\n  });\n}\n\n/**\n * This is a function for turning a Promise into the kind referenced in the\n * Legacy Interface Extensions section of the WebRTC spec.\n * @param {Promise<*>} promise\n * @param {function<*>} onSuccess\n * @param {function<Error>} onFailure\n * @returns {Promise<undefined>}\n */\nfunction legacyPromise(promise, onSuccess, onFailure) {\n  if (onSuccess) {\n    return promise.then(function (result) {\n      onSuccess(result);\n    }, function (error) {\n      onFailure(error);\n    });\n  }\n  return promise;\n}\n\n/**\n * Build the {@link LogLevels} object.\n * @param {String|LogLevel} logLevel - Log level name or object\n * @returns {LogLevels}\n */\nfunction buildLogLevels(logLevel) {\n  if (typeof logLevel === 'string') {\n    return {\n      default: logLevel,\n      media: logLevel,\n      signaling: logLevel,\n      webrtc: logLevel\n    };\n  }\n  return logLevel;\n}\n\n/**\n * Get the {@link Track}'s derived class name\n * @param {Track} track\n * @param {?boolean} [local=undefined]\n * @returns {string}\n */\nfunction trackClass(track, local) {\n  local = local ? 'Local' : '';\n  return local + (track.kind || '').replace(/\\w{1}/, function (m) {\n    return m.toUpperCase();\n  }) + 'Track';\n}\n\n/**\n * Get the {@link TrackPublication}'s derived class name\n * @param {TrackPublication} publication\n * @param {?boolean} [local=undefined]\n * @returns {string}\n */\nfunction trackPublicationClass(publication, local) {\n  local = local ? 'Local' : '';\n  return local + (publication.kind || '').replace(/\\w{1}/, function (m) {\n    return m.toUpperCase();\n  }) + 'TrackPublication';\n}\n\n/**\n * Sets all underscore-prefixed properties on `object` non-enumerable.\n * @param {Object} object\n * @returns {void}\n */\nfunction hidePrivateProperties(object) {\n  Object.getOwnPropertyNames(object).forEach(function (name) {\n    if (name.startsWith('_')) {\n      hideProperty(object, name);\n    }\n  });\n}\n\n/**\n * Creates a new subclass which, in the constructor, sets all underscore-prefixed\n * properties and the given public properties non-enumerable. This is useful for\n * patching up classes like EventEmitter which may set properties like `_events`\n * and `domain`.\n * @param {Function} klass\n * @param {Array<string>} props\n * @returns {Function} subclass\n */\nfunction hidePrivateAndCertainPublicPropertiesInClass(klass, props) {\n  // NOTE(mroberts): We do this to avoid giving the class a name.\n  return function (_klass) {\n    _inherits(_class, _klass);\n\n    function _class() {\n      var _ref;\n\n      _classCallCheck(this, _class);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var _this = _possibleConstructorReturn(this, (_ref = _class.__proto__ || Object.getPrototypeOf(_class)).call.apply(_ref, [this].concat(args)));\n\n      hidePrivateProperties(_this);\n      hidePublicProperties(_this, props);\n      return _this;\n    }\n\n    return _class;\n  }(klass);\n}\n\n/**\n * Hide a property of an object.\n * @param {object} object\n * @param {string} name\n */\nfunction hideProperty(object, name) {\n  var descriptor = Object.getOwnPropertyDescriptor(object, name);\n  descriptor.enumerable = false;\n  Object.defineProperty(object, name, descriptor);\n}\n\n/**\n * Hide the given public properties of an object.\n * @param {object} object\n * @param {Array<string>} [props=[]]\n */\nfunction hidePublicProperties(object) {\n  var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  props.forEach(function (name) {\n    // eslint-disable-next-line no-prototype-builtins\n    if (object.hasOwnProperty(name)) {\n      hideProperty(object, name);\n    }\n  });\n}\n\n/**\n * Convert an Array of values to an Array of JSON values by calling\n * `valueToJSON` on each value.\n * @param {Array<*>} array\n * @returns {Array<*>}\n */\nfunction arrayToJSON(array) {\n  return array.map(valueToJSON);\n}\n\n/**\n * Convert a Set of values to an Array of JSON values by calling `valueToJSON`\n * on each value.\n * @param {Set<*>} set\n * @returns {Array<*>}\n */\nfunction setToJSON(set) {\n  return arrayToJSON([].concat(_toConsumableArray(set)));\n}\n\n/**\n * Convert a Map from strings to values to an object of JSON values by calling\n * `valueToJSON` on each value.\n * @param {Map<string, *>} map\n * @returns {object}\n */\nfunction mapToJSON(map) {\n  return [].concat(_toConsumableArray(map.entries())).reduce(function (json, _ref2) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        key = _ref3[0],\n        value = _ref3[1];\n\n    return Object.assign(_defineProperty({}, key, valueToJSON(value)), json);\n  }, {});\n}\n\n/**\n * Convert an object to a JSON value by calling `valueToJSON` on its enumerable\n * keys.\n * @param {object} object\n * @returns {object}\n */\nfunction objectToJSON(object) {\n  return Object.entries(object).reduce(function (json, _ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        key = _ref5[0],\n        value = _ref5[1];\n\n    return Object.assign(_defineProperty({}, key, valueToJSON(value)), json);\n  }, {});\n}\n\n/**\n * Convert a value into a JSON value.\n * @param {*} value\n * @returns {*}\n */\nfunction valueToJSON(value) {\n  if (Array.isArray(value)) {\n    return arrayToJSON(value);\n  } else if (value instanceof Set) {\n    return setToJSON(value);\n  } else if (value instanceof Map) {\n    return mapToJSON(value);\n  } else if (value && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object') {\n    return objectToJSON(value);\n  }\n  return value;\n}\n\n/**\n * Create the bandwidth profile payload included in an RSP connect message.\n * @param {BandwidthProfileOptions} bandwidthProfile\n * @returns {object}\n */\nfunction createBandwidthProfilePayload(bandwidthProfile) {\n  return createRSPPayload(bandwidthProfile, [{ prop: 'video', type: 'object', transform: createBandwidthProfileVideoPayload }]);\n}\n\n/**\n * Create the bandwidth profile video payload included in an RSP connect message.\n * @param {VideoBandwidthProfileOptions} bandwidthProfileVideo\n * @returns {object}\n */\nfunction createBandwidthProfileVideoPayload(bandwidthProfileVideo) {\n  return createRSPPayload(bandwidthProfileVideo, [{ prop: 'dominantSpeakerPriority', type: 'string', payloadProp: 'active_speaker_priority' }, { prop: 'maxSubscriptionBitrate', type: 'number', payloadProp: 'max_subscription_bandwidth' }, { prop: 'maxTracks', type: 'number', payloadProp: 'max_tracks' }, { prop: 'mode', type: 'string' }, { prop: 'renderDimensions', type: 'object', payloadProp: 'render_dimensions', transform: createRenderDimensionsPayload }, { prop: 'trackSwitchOffMode', type: 'string', payloadProp: 'track_switch_off' }]);\n}\n\n/**\n * Create the Media Signaling payload included in an RSP connect message.\n * @param {boolean} dominantSpeaker - whether to enable the Dominant Speaker\n *   protocol or not\n * @param {boolean} networkQuality - whether to enable the Network Quality\n *   protocol or not\n * @param {boolean} trackPriority - whether to enable the Track Priority\n *   protocol or not\n * @param {boolean} trackSwitchOff - whether to enable the Track Switch-Off\n *   protocol or not.\n * @returns {object}\n */\nfunction createMediaSignalingPayload(dominantSpeaker, networkQuality, trackPriority, trackSwitchOff) {\n  var transports = { transports: [{ type: 'data-channel' }] };\n  return Object.assign(dominantSpeaker\n  // eslint-disable-next-line\n  ? { active_speaker: transports } : {}, networkQuality\n  // eslint-disable-next-line\n  ? { network_quality: transports } : {}, trackPriority\n  // eslint-disable-next-line\n  ? { track_priority: transports } : {}, trackSwitchOff\n  // eslint-disable-next-line\n  ? { track_switch_off: transports } : {});\n}\n\n/**\n * Create {@link VideoTrack.Dimensions} RSP payload.\n * @param {VideoTrack.Dimensions} [dimensions]\n * @returns {object}\n */\nfunction createDimensionsPayload(dimensions) {\n  return createRSPPayload(dimensions, [{ prop: 'height', type: 'number' }, { prop: 'width', type: 'number' }]);\n}\n\n/**\n * Create {@link VideoRenderDimensions} RSP payload.\n * @param renderDimensions\n * @returns {object}\n */\nfunction createRenderDimensionsPayload(renderDimensions) {\n  var PRIORITY_HIGH = trackPriority.PRIORITY_HIGH,\n      PRIORITY_LOW = trackPriority.PRIORITY_LOW,\n      PRIORITY_STANDARD = trackPriority.PRIORITY_STANDARD;\n\n  return createRSPPayload(renderDimensions, [{ prop: PRIORITY_HIGH, type: 'object', transform: createDimensionsPayload }, { prop: PRIORITY_LOW, type: 'object', transform: createDimensionsPayload }, { prop: PRIORITY_STANDARD, type: 'object', transform: createDimensionsPayload }]);\n}\n\n/**\n * Create an RSP payload for the given object.\n * @param {object} object - object for which RSP payload is to be generated\n * @param {Array<object>} propConversions - conversion rules for object properties;\n *   they specify how object properties should be converted to their corresponding\n *   RSP payload properties\n * @returns {object}\n */\nfunction createRSPPayload(object, propConversions) {\n  return propConversions.reduce(function (payload, _ref6) {\n    var prop = _ref6.prop,\n        type = _ref6.type,\n        _ref6$payloadProp = _ref6.payloadProp,\n        payloadProp = _ref6$payloadProp === undefined ? prop : _ref6$payloadProp,\n        _ref6$transform = _ref6.transform,\n        transform = _ref6$transform === undefined ? function (x) {\n      return x;\n    } : _ref6$transform;\n\n    return _typeof(object[prop]) === type ? Object.assign(_defineProperty({}, payloadProp, transform(object[prop])), payload) : payload;\n  }, {});\n}\n\n/**\n * Create the subscribe payload included in an RSP connect/update message.\n * @param {boolean} automaticSubscription - whether to subscribe to all RemoteTracks\n * @returns {object}\n */\nfunction createSubscribePayload(automaticSubscription) {\n  return {\n    rules: [{\n      type: automaticSubscription ? 'include' : 'exclude',\n      all: true\n    }],\n    revision: 1\n  };\n}\n\n/**\n * Add random jitter to a given value in the range [-jitter, jitter].\n * @private\n * @param {number} value\n * @param {number} jitter\n * @returns {number} value + random(-jitter, +jitter)\n */\nfunction withJitter(value, jitter) {\n  var rand = Math.random();\n  return value - jitter + Math.floor(2 * jitter * rand + 0.5);\n}\n\n/**\n * Checks if the a number is in the range [min, max].\n * @private\n * @param {num} num\n * @param {number} min\n * @param {number} max\n * @return {boolean}\n */\nfunction inRange(num, min, max) {\n  return min <= num && num <= max;\n}\n\n/**\n * returns true if given MediaStreamTrack is a screen share track\n * @private\n * @param {MediaStreamTrack} track\n * @returns {boolean}\n */\nfunction isChromeScreenShareTrack(track) {\n  // NOTE(mpatwardhan): Chrome creates screen share tracks with label like: \"screen:69734272*\"\n  // we will check for label that starts with \"screen:D\" where D being a digit.\n  var isChrome = util.guessBrowser() === 'chrome';\n  return isChrome && track.kind === 'video' && track.label && /^screen:[0-9]+/.test(track.label);\n}\n\nexports.constants = constants;\nexports.createBandwidthProfilePayload = createBandwidthProfilePayload;\nexports.createMediaSignalingPayload = createMediaSignalingPayload;\nexports.createSubscribePayload = createSubscribePayload;\nexports.asLocalTrack = asLocalTrack;\nexports.asLocalTrackPublication = asLocalTrackPublication;\nexports.capitalize = capitalize;\nexports.deprecateEvents = deprecateEvents;\nexports.difference = difference;\nexports.filterObject = filterObject;\nexports.flatMap = flatMap;\nexports.getUserAgent = getUserAgent;\nexports.hidePrivateProperties = hidePrivateProperties;\nexports.hidePrivateAndCertainPublicPropertiesInClass = hidePrivateAndCertainPublicPropertiesInClass;\nexports.isDeepEqual = isDeepEqual;\nexports.isNonArrayObject = isNonArrayObject;\nexports.inRange = inRange;\nexports.makeUUID = makeUUID;\nexports.oncePerTick = oncePerTick;\nexports.promiseFromEvents = promiseFromEvents;\nexports.getOrNull = getOrNull;\nexports.defer = defer;\nexports.delegateMethods = delegateMethods;\nexports.proxyProperties = proxyProperties;\nexports.legacyPromise = legacyPromise;\nexports.buildLogLevels = buildLogLevels;\nexports.trackClass = trackClass;\nexports.trackPublicationClass = trackPublicationClass;\nexports.valueToJSON = valueToJSON;\nexports.withJitter = withJitter;\nexports.isChromeScreenShareTrack = isChromeScreenShareTrack;"]},"metadata":{},"sourceType":"script"}