{"ast":null,"code":"import { useEffect, useState } from 'react';\nimport useVideoContext from '../useVideoContext/useVideoContext';\n\n/*\n  Returns the participant that is sharing their screen (if any). This hook assumes that only one participant\n  can share their screen at a time.\n*/\nexport default function useScreenShareParticipant() {\n  const {\n    room\n  } = useVideoContext();\n  const [screenShareParticipant, setScreenShareParticipant] = useState();\n  useEffect(() => {\n    if (room.state === 'connected') {\n      const updateScreenShareParticipant = () => {\n        setScreenShareParticipant(Array.from(room.participants.values()) // the screenshare participant could be the localParticipant\n        .concat(room.localParticipant).find(participant => Array.from(participant.tracks.values()).find(track => track.trackName === 'screen')));\n      };\n\n      updateScreenShareParticipant();\n      room.on('trackPublished', updateScreenShareParticipant);\n      room.on('trackUnpublished', updateScreenShareParticipant);\n      room.on('participantDisconnected', updateScreenShareParticipant); // the room object does not emit 'trackPublished' events for the localParticipant,\n      // so we need to listen for them here.\n\n      room.localParticipant.on('trackPublished', updateScreenShareParticipant);\n      room.localParticipant.on('trackUnpublished', updateScreenShareParticipant);\n      return () => {\n        room.off('trackPublished', updateScreenShareParticipant);\n        room.off('trackUnpublished', updateScreenShareParticipant);\n        room.off('participantDisconnected', updateScreenShareParticipant);\n        room.localParticipant.off('trackPublished', updateScreenShareParticipant);\n        room.localParticipant.off('trackUnpublished', updateScreenShareParticipant);\n      };\n    }\n  }, [room]);\n  return screenShareParticipant;\n}","map":{"version":3,"sources":["/home/ascencion/sebrae_megahack/src/hooks/useScreenShareParticipant/useScreenShareParticipant.tsx"],"names":["useEffect","useState","useVideoContext","useScreenShareParticipant","room","screenShareParticipant","setScreenShareParticipant","state","updateScreenShareParticipant","Array","from","participants","values","concat","localParticipant","find","participant","tracks","track","trackName","on","off"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,OAAOC,eAAP,MAA4B,oCAA5B;;AAIA;;;;AAIA,eAAe,SAASC,yBAAT,GAAqC;AAClD,QAAM;AAAEC,IAAAA;AAAF,MAAWF,eAAe,EAAhC;AACA,QAAM,CAACG,sBAAD,EAAyBC,yBAAzB,IAAsDL,QAAQ,EAApE;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACd,QAAII,IAAI,CAACG,KAAL,KAAe,WAAnB,EAAgC;AAC9B,YAAMC,4BAA4B,GAAG,MAAM;AACzCF,QAAAA,yBAAyB,CACvBG,KAAK,CAACC,IAAN,CAAwBN,IAAI,CAACO,YAAL,CAAkBC,MAAlB,EAAxB,EACE;AADF,SAEGC,MAFH,CAEUT,IAAI,CAACU,gBAFf,EAGGC,IAHH,CAGSC,WAAD,IACJP,KAAK,CAACC,IAAN,CAA6BM,WAAW,CAACC,MAAZ,CAAmBL,MAAnB,EAA7B,EAA0DG,IAA1D,CAA+DG,KAAK,IAAIA,KAAK,CAACC,SAAN,KAAoB,QAA5F,CAJJ,CADuB,CAAzB;AAQD,OATD;;AAUAX,MAAAA,4BAA4B;AAE5BJ,MAAAA,IAAI,CAACgB,EAAL,CAAQ,gBAAR,EAA0BZ,4BAA1B;AACAJ,MAAAA,IAAI,CAACgB,EAAL,CAAQ,kBAAR,EAA4BZ,4BAA5B;AACAJ,MAAAA,IAAI,CAACgB,EAAL,CAAQ,yBAAR,EAAmCZ,4BAAnC,EAf8B,CAiB9B;AACA;;AACAJ,MAAAA,IAAI,CAACU,gBAAL,CAAsBM,EAAtB,CAAyB,gBAAzB,EAA2CZ,4BAA3C;AACAJ,MAAAA,IAAI,CAACU,gBAAL,CAAsBM,EAAtB,CAAyB,kBAAzB,EAA6CZ,4BAA7C;AACA,aAAO,MAAM;AACXJ,QAAAA,IAAI,CAACiB,GAAL,CAAS,gBAAT,EAA2Bb,4BAA3B;AACAJ,QAAAA,IAAI,CAACiB,GAAL,CAAS,kBAAT,EAA6Bb,4BAA7B;AACAJ,QAAAA,IAAI,CAACiB,GAAL,CAAS,yBAAT,EAAoCb,4BAApC;AAEAJ,QAAAA,IAAI,CAACU,gBAAL,CAAsBO,GAAtB,CAA0B,gBAA1B,EAA4Cb,4BAA5C;AACAJ,QAAAA,IAAI,CAACU,gBAAL,CAAsBO,GAAtB,CAA0B,kBAA1B,EAA8Cb,4BAA9C;AACD,OAPD;AAQD;AACF,GA/BQ,EA+BN,CAACJ,IAAD,CA/BM,CAAT;AAiCA,SAAOC,sBAAP;AACD","sourcesContent":["import { useEffect, useState } from 'react';\nimport useVideoContext from '../useVideoContext/useVideoContext';\n\nimport { Participant, TrackPublication } from 'twilio-video';\n\n/*\n  Returns the participant that is sharing their screen (if any). This hook assumes that only one participant\n  can share their screen at a time.\n*/\nexport default function useScreenShareParticipant() {\n  const { room } = useVideoContext();\n  const [screenShareParticipant, setScreenShareParticipant] = useState<Participant>();\n\n  useEffect(() => {\n    if (room.state === 'connected') {\n      const updateScreenShareParticipant = () => {\n        setScreenShareParticipant(\n          Array.from<Participant>(room.participants.values())\n            // the screenshare participant could be the localParticipant\n            .concat(room.localParticipant)\n            .find((participant: Participant) =>\n              Array.from<TrackPublication>(participant.tracks.values()).find(track => track.trackName === 'screen')\n            )\n        );\n      };\n      updateScreenShareParticipant();\n\n      room.on('trackPublished', updateScreenShareParticipant);\n      room.on('trackUnpublished', updateScreenShareParticipant);\n      room.on('participantDisconnected', updateScreenShareParticipant);\n\n      // the room object does not emit 'trackPublished' events for the localParticipant,\n      // so we need to listen for them here.\n      room.localParticipant.on('trackPublished', updateScreenShareParticipant);\n      room.localParticipant.on('trackUnpublished', updateScreenShareParticipant);\n      return () => {\n        room.off('trackPublished', updateScreenShareParticipant);\n        room.off('trackUnpublished', updateScreenShareParticipant);\n        room.off('participantDisconnected', updateScreenShareParticipant);\n\n        room.localParticipant.off('trackPublished', updateScreenShareParticipant);\n        room.localParticipant.off('trackUnpublished', updateScreenShareParticipant);\n      };\n    }\n  }, [room]);\n\n  return screenShareParticipant;\n}\n"]},"metadata":{},"sourceType":"module"}